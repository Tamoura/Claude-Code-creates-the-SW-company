# All-Agent Showcase Workflow — New Product Template
# Engages ALL 14+ ConnectSW agents across 6 phases.
# Use for flagship products that demonstrate full platform capability.
#
# Placeholders: {PRODUCT}, {DESCRIPTION}, {FRONTEND_PORT}, {BACKEND_PORT}
#
# TRACEABILITY RULES (Constitution Article VI):
#   - Every task MUST have story_ids and/or requirement_ids once PRD exists
#   - Planning tasks (STRATEGY-01, PRD-01, etc.) create stories
#   - Commits MUST include [US-XX] or [FR-XXX] in the message
#   - Tests MUST reference acceptance criteria: test('[US-XX][AC-X] desc', ...)
#   - E2E tests organized by story: e2e/tests/stories/{story-id}/

metadata:
  product: "{PRODUCT}"
  version: "3.0.0"
  workflow_type: "new-product-showcase"
  created_at: "{TIMESTAMP}"
  updated_at: "{TIMESTAMP}"
  ports:
    frontend: {FRONTEND_PORT}
    backend: {BACKEND_PORT}
  traceability:
    brd_ref: "products/{PRODUCT}/docs/PRD.md"
    epic: "EP-{PRODUCT}-FOUNDATION"
    sprint: "Sprint 0 — Foundation"

tasks:
  # ============================================================================
  # PHASE 0: STRATEGY & INNOVATION
  # Agents: Product Strategist, Innovation Specialist
  # Purpose: Market validation and differentiation BEFORE writing the PRD
  # ============================================================================

  - id: "STRATEGY-01"
    name: "Market Analysis & Competitive Positioning"
    description: |
      Analyze the market landscape for: {DESCRIPTION}
      Deliver:
      - Competitive analysis (3+ direct competitors, strengths/weaknesses)
      - SWOT analysis for ConnectSW entering this market
      - Target market sizing (TAM/SAM/SOM)
      - Differentiation strategy (what makes ours unique)
      - Go-to-market positioning
      - Risk assessment (market timing, competition, resources)
    agent: "product-strategist"
    depends_on: []
    epic: "EP-{PRODUCT}-STRATEGY"
    produces:
      - name: "Market Analysis"
        type: "document"
        path: "products/{PRODUCT}/docs/strategy/MARKET-ANALYSIS.md"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 60
    acceptance_criteria:
      - "3+ competitors analyzed with strengths/weaknesses"
      - "SWOT analysis complete"
      - "Clear differentiation strategy defined"
      - "Market sizing included (TAM/SAM/SOM)"
      - "Mermaid diagrams for competitive landscape"
    status: "pending"

  - id: "INNOVATE-01"
    name: "Innovation & Differentiator Research"
    description: |
      Research emerging technologies and innovative features for: {DESCRIPTION}
      Deliver:
      - 5+ innovative feature ideas that differentiate from competitors
      - AI/ML integration opportunities
      - Emerging tech applicability (real-time, AI, blockchain, etc.)
      - Viability assessment for each innovation
      - Recommendation: adopt/explore/shelve for each
    agent: "innovation-specialist"
    depends_on: []
    epic: "EP-{PRODUCT}-STRATEGY"
    produces:
      - name: "Innovation Brief"
        type: "document"
        path: "products/{PRODUCT}/docs/strategy/INNOVATION-BRIEF.md"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 45
    acceptance_criteria:
      - "5+ innovative feature ideas documented"
      - "AI/ML integration opportunities identified"
      - "Viability scored for each (technical, business, competitive)"
      - "Clear adopt/explore/shelve recommendation per idea"
    status: "pending"

  # ============================================================================
  # PHASE 1: INCEPTION & DESIGN
  # Agents: Product Manager, UI/UX Designer
  # Purpose: Comprehensive PRD + design system + wireframes
  # ============================================================================

  - id: "PRD-01"
    name: "Create Product Requirements Document"
    description: |
      Create comprehensive PRD using market analysis and innovation brief.
      CEO brief: {DESCRIPTION}

      MUST include:
      - Business context (problem, market, value proposition)
      - User personas (3+) with demographics, goals, pain points
      - Epics with unique IDs (EP-XX)
      - User stories with unique IDs (US-XX) and acceptance criteria (Given/When/Then)
      - Functional requirements (FR-XXX) mapped to stories
      - Non-functional requirements (NFR-XXX)
      - Site map with ALL routes (even placeholder pages)
      - User journey flowcharts (Mermaid)
      - Success metrics (measurable)
      - MVP scope (Phase 1) vs Phase 2 vs Future
      - Out of scope (explicit)
      - Risks with mitigation

      TRACEABILITY: This creates ALL IDs (EP-XX, US-XX, FR-XXX, NFR-XXX).
    agent: "product-manager"
    depends_on: ["STRATEGY-01", "INNOVATE-01"]
    epic: "EP-{PRODUCT}-INCEPTION"
    produces:
      - name: "PRD"
        type: "document"
        path: "products/{PRODUCT}/docs/PRD.md"
      - name: "Product Addendum"
        type: "document"
        path: "products/{PRODUCT}/.claude/addendum.md"
    parallel_ok: false
    checkpoint: true
    priority: "critical"
    estimated_time_minutes: 120
    acceptance_criteria:
      - "3+ personas with demographics, goals, pain points"
      - "All user stories have unique IDs (US-XX) with Given/When/Then AC"
      - "All requirements have unique IDs (FR-XXX, NFR-XXX)"
      - "Site map covers all routes"
      - "User journey flowcharts in Mermaid"
      - "MVP scope clearly defined"
      - "Out of scope documented"
      - "Risks with mitigation strategies"
      - "C4 Context diagram (Level 1)"
      - "Success metrics are measurable"
    status: "pending"

  - id: "UIUX-01"
    name: "Design System & Wireframes"
    description: |
      Create comprehensive design specifications:
      - Design system (colors, typography, spacing, components)
      - ASCII wireframes for all MVP pages
      - Interaction states (hover, focus, active, disabled, error)
      - Mobile-first responsive breakpoints
      - WCAG 2.1 AA accessibility requirements
      - Component inventory (what to build vs reuse from shadcn/ui)
      - Page-by-page design specs
      - Navigation architecture (information architecture)
    agent: "ui-ux-designer"
    depends_on: ["PRD-01"]
    epic: "EP-{PRODUCT}-INCEPTION"
    produces:
      - name: "Design System"
        type: "document"
        path: "products/{PRODUCT}/docs/design/DESIGN-SYSTEM.md"
      - name: "Wireframes"
        type: "document"
        path: "products/{PRODUCT}/docs/design/WIREFRAMES.md"
      - name: "Accessibility Spec"
        type: "document"
        path: "products/{PRODUCT}/docs/design/ACCESSIBILITY.md"
    parallel_ok: false
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 90
    acceptance_criteria:
      - "Color palette with hex codes and WCAG contrast ratios"
      - "Typography scale defined (sizes, weights, line heights)"
      - "8px grid spacing system"
      - "ASCII wireframes for all MVP pages"
      - "All interaction states documented"
      - "Mobile-first responsive breakpoints"
      - "WCAG 2.1 AA checklist"
      - "Component inventory with shadcn/ui mapping"
    status: "pending"

  # ============================================================================
  # PHASE 2: ARCHITECTURE & SECURITY
  # Agents: Architect, Security Engineer
  # ============================================================================

  - id: "ARCH-01"
    name: "Design System Architecture"
    description: |
      Create comprehensive system architecture:
      - C4 diagrams (Context, Container, Component) in Mermaid
      - API contracts with full endpoint specs
      - Database schema (ER diagram in Mermaid)
      - Technology stack confirmation with ADRs
      - Traceability matrix: US-XX -> FR-XXX -> endpoint -> DB table
      - Sequence diagrams for all multi-step flows
      - State diagrams for lifecycle entities

      Use design specs from UI/UX to inform API contracts.
    agent: "architect"
    depends_on: ["PRD-01", "UIUX-01"]
    epic: "EP-{PRODUCT}-ARCHITECTURE"
    produces:
      - name: "Architecture Document"
        type: "document"
        path: "products/{PRODUCT}/docs/architecture.md"
      - name: "ADRs"
        type: "directory"
        path: "products/{PRODUCT}/docs/ADRs/"
    parallel_ok: true
    checkpoint: true
    priority: "critical"
    estimated_time_minutes: 120
    acceptance_criteria:
      - "C4 Level 1 (Context), Level 2 (Container), Level 3 (Component) diagrams"
      - "All MVP API endpoints defined with request/response schemas"
      - "ER diagram with all entities and relationships"
      - "Traceability matrix: US -> FR -> endpoint -> table"
      - "Sequence diagrams for auth, main user flows"
      - "State diagrams for lifecycle entities"
      - "At least 3 ADRs (tech stack, auth, data model)"
    status: "pending"

  - id: "SECURITY-01"
    name: "Security Architecture & Threat Model"
    description: |
      Create security architecture and threat model:
      - STRIDE threat modeling
      - Authentication architecture (JWT, OAuth, session management)
      - Authorization model (RBAC, permissions)
      - Data protection (encryption at rest/transit, PII handling)
      - Input validation strategy
      - Rate limiting plan
      - Security headers (CORS, CSP, HSTS)
      - OWASP Top 10 mitigation plan
    agent: "security-engineer"
    depends_on: ["ARCH-01"]
    epic: "EP-{PRODUCT}-ARCHITECTURE"
    produces:
      - name: "Security Architecture"
        type: "document"
        path: "products/{PRODUCT}/docs/SECURITY.md"
      - name: "Threat Model"
        type: "document"
        path: "products/{PRODUCT}/docs/ADRs/ADR-SECURITY.md"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 60
    acceptance_criteria:
      - "STRIDE threat model complete"
      - "Auth architecture documented (JWT + OAuth)"
      - "RBAC permission model defined"
      - "Data protection strategy (PII, encryption)"
      - "OWASP Top 10 mitigations documented"
      - "Rate limiting plan"
    status: "pending"

  # ============================================================================
  # PHASE 3: FOUNDATION (Parallel)
  # Agents: Backend, Frontend, DevOps
  # ============================================================================

  - id: "DEVOPS-01"
    name: "Setup CI/CD Pipeline & Infrastructure"
    description: |
      Configure deployment infrastructure:
      - GitHub Actions workflows (build, test, deploy)
      - Docker configuration (docker-compose.yml)
      - Environment setup (.env.example)
      - Database provisioning (PostgreSQL + Redis)
      - Port configuration: frontend={FRONTEND_PORT}, backend={BACKEND_PORT}
    agent: "devops-engineer"
    depends_on: ["ARCH-01"]
    requirement_ids: ["NFR-INFRA"]
    epic: "EP-{PRODUCT}-FOUNDATION"
    produces:
      - name: "CI Workflow"
        type: "file"
        path: ".github/workflows/{PRODUCT}-ci.yml"
      - name: "Docker Compose"
        type: "file"
        path: "products/{PRODUCT}/docker-compose.yml"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 60
    acceptance_criteria:
      - "CI workflow runs on PR (lint, test, build)"
      - "Docker build succeeds"
      - "docker-compose up starts all services"
      - "Environment variables documented in .env.example"
    status: "pending"

  - id: "BACKEND-01"
    name: "Implement Backend Foundation"
    description: |
      Setup backend API:
      - Fastify application with TypeScript
      - Prisma ORM with schema from architecture
      - Database migrations
      - Auth (signup, login, JWT)
      - Health check endpoint
      - CORS, rate limiting, security headers
      - Core API endpoints for MVP features
      - Unit tests (TDD: red-green-refactor)
      - Port: {BACKEND_PORT}

      Use security architecture for auth implementation.
    agent: "backend-engineer"
    depends_on: ["ARCH-01", "SECURITY-01"]
    story_ids: ["{FOUNDATION_STORY_IDS}"]
    requirement_ids: ["{FOUNDATION_REQUIREMENT_IDS}"]
    epic: "EP-{PRODUCT}-FOUNDATION"
    produces:
      - name: "Backend App"
        type: "directory"
        path: "products/{PRODUCT}/apps/api"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 180
    acceptance_criteria:
      - "Fastify server starts on port {BACKEND_PORT}"
      - "Database connection works"
      - "Auth endpoints (signup, login, refresh) working"
      - "Health check returns 200"
      - "Core MVP endpoints implemented"
      - "15+ unit tests passing"
      - "Test coverage > 80%"
      - "All commits reference [US-XX] or [FR-XXX]"
    status: "pending"

  - id: "FRONTEND-01"
    name: "Implement Frontend Foundation"
    description: |
      Setup frontend using UI/UX design specs:
      - Next.js 14+ with App Router
      - Tailwind CSS with design system tokens
      - Layout components (header, sidebar, footer)
      - All MVP pages from site map
      - Responsive design (mobile-first per wireframes)
      - API integration with backend
      - Component tests with React Testing Library
      - Port: {FRONTEND_PORT}

      Follow wireframes and design system from UIUX-01 exactly.
    agent: "frontend-engineer"
    depends_on: ["ARCH-01", "UIUX-01"]
    story_ids: ["{FOUNDATION_STORY_IDS}"]
    requirement_ids: ["{FOUNDATION_REQUIREMENT_IDS}"]
    epic: "EP-{PRODUCT}-FOUNDATION"
    produces:
      - name: "Frontend App"
        type: "directory"
        path: "products/{PRODUCT}/apps/web"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 180
    acceptance_criteria:
      - "Next.js dev server starts on port {FRONTEND_PORT}"
      - "All MVP pages render without errors"
      - "Design system tokens applied (colors, typography, spacing)"
      - "Responsive on mobile and desktop"
      - "API calls to backend work"
      - "10+ component tests passing"
      - "No console errors"
      - "All commits reference [US-XX] or [FR-XXX]"
    status: "pending"

  # ============================================================================
  # PHASE 4: QUALITY & REVIEW
  # Agents: QA, Code Reviewer
  # ============================================================================

  - id: "QA-01"
    name: "E2E Test Suite & Quality Assurance"
    description: |
      Comprehensive testing:
      - Playwright E2E tests organized by story ID
      - Smoke tests for all pages
      - Auth flow tests (signup, login, logout)
      - Core feature tests
      - Cross-browser testing (Chrome, Firefox)
      - Accessibility testing (axe-core)
      - Performance benchmarks
    agent: "qa-engineer"
    depends_on: ["BACKEND-01", "FRONTEND-01"]
    story_ids: ["{ALL_MVP_STORY_IDS}"]
    epic: "EP-{PRODUCT}-QUALITY"
    produces:
      - name: "E2E Tests"
        type: "directory"
        path: "products/{PRODUCT}/e2e"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 90
    acceptance_criteria:
      - "10+ E2E tests passing"
      - "Tests organized by story: e2e/tests/stories/{story-id}/"
      - "Auth flow fully tested"
      - "All MVP pages smoke-tested"
      - "Accessibility scan passes (no critical violations)"
      - "Test names include [US-XX][AC-X]"
    status: "pending"

  - id: "REVIEW-01"
    name: "Code Review & Security Audit"
    description: |
      Comprehensive code review:
      - Code quality audit (patterns, anti-patterns, tech debt)
      - Security review (OWASP Top 10, auth implementation)
      - Performance review (N+1 queries, bundle size)
      - Accessibility review (WCAG compliance)
      - API contract compliance (matches architecture spec)
      - Test coverage analysis
      - Generate improvement recommendations
    agent: "code-reviewer"
    depends_on: ["BACKEND-01", "FRONTEND-01"]
    epic: "EP-{PRODUCT}-QUALITY"
    produces:
      - name: "Code Review Report"
        type: "document"
        path: "products/{PRODUCT}/docs/quality-reports/code-review.md"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 45
    acceptance_criteria:
      - "All critical issues flagged"
      - "Security vulnerabilities identified and severity rated"
      - "Performance recommendations provided"
      - "Code follows ConnectSW standards"
      - "No OWASP Top 10 vulnerabilities"
    status: "pending"

  - id: "QA-02"
    name: "Run Testing Gate - Foundation"
    description: |
      Execute complete quality gate:
      - Run all unit tests (backend + frontend)
      - Run all E2E tests
      - Verify app loads in browser
      - Check for console errors
      - Generate requirement coverage matrix
      - Verify all acceptance criteria have tests
    agent: "qa-engineer"
    depends_on: ["QA-01", "REVIEW-01"]
    epic: "EP-{PRODUCT}-QUALITY"
    produces:
      - name: "Test Report"
        type: "document"
        path: "products/{PRODUCT}/docs/test-reports/foundation.md"
    parallel_ok: false
    checkpoint: false
    priority: "critical"
    estimated_time_minutes: 30
    acceptance_criteria:
      - "All unit tests pass"
      - "All E2E tests pass"
      - "App loads without errors"
      - "Requirement coverage matrix shows 100% MVP coverage"
    status: "pending"

  # ============================================================================
  # PHASE 5: DOCUMENTATION & SUPPORT
  # Agents: Technical Writer, Support Engineer
  # ============================================================================

  - id: "DOCS-01"
    name: "Create Comprehensive Documentation"
    description: |
      Full documentation suite:
      - README with business context, setup, architecture diagram
      - API documentation (all endpoints with FR-XXX mapping)
      - Development guide (setup, testing, deployment)
      - User guide
      - All diagrams verified rendering
    agent: "technical-writer"
    depends_on: ["BACKEND-01", "FRONTEND-01", "DEVOPS-01"]
    epic: "EP-{PRODUCT}-DOCUMENTATION"
    produces:
      - name: "README"
        type: "file"
        path: "products/{PRODUCT}/README.md"
      - name: "API Docs"
        type: "file"
        path: "products/{PRODUCT}/docs/API.md"
    parallel_ok: true
    checkpoint: false
    priority: "normal"
    estimated_time_minutes: 60
    acceptance_criteria:
      - "README has business context + architecture diagram"
      - "API endpoints documented with FR-XXX IDs"
      - "Setup instructions actually work"
      - "All Mermaid diagrams render correctly"
    status: "pending"

  - id: "SUPPORT-01"
    name: "Create Support Playbook & FAQ"
    description: |
      Support readiness:
      - Common issues and resolutions
      - FAQ for end users
      - Troubleshooting guide
      - Error code reference
      - Escalation procedures
    agent: "support-engineer"
    depends_on: ["BACKEND-01", "FRONTEND-01"]
    epic: "EP-{PRODUCT}-DOCUMENTATION"
    produces:
      - name: "Support Playbook"
        type: "document"
        path: "products/{PRODUCT}/docs/SUPPORT-PLAYBOOK.md"
    parallel_ok: true
    checkpoint: false
    priority: "normal"
    estimated_time_minutes: 30
    acceptance_criteria:
      - "10+ common issues documented with resolutions"
      - "FAQ covers user questions"
      - "Error codes mapped to user-friendly messages"
      - "Escalation procedure defined"
    status: "pending"

  # ============================================================================
  # CHECKPOINT: FOUNDATION COMPLETE
  # ============================================================================

  - id: "CHECKPOINT-FOUNDATION"
    name: "Foundation Complete - CEO Review"
    description: |
      All 14 agents have contributed. Foundation ready for CEO review:
      - Strategy & market analysis complete
      - PRD with full user stories and acceptance criteria
      - Design system and wireframes
      - Architecture with C4 diagrams and traceability
      - Security architecture and threat model
      - Backend API running with tests
      - Frontend app running with tests
      - CI/CD pipeline
      - E2E tests passing
      - Code review complete
      - Documentation complete
      - Support playbook ready
    agent: "orchestrator"
    depends_on: ["QA-02", "DOCS-01", "SUPPORT-01"]
    parallel_ok: false
    checkpoint: true
    priority: "critical"
    estimated_time_minutes: 0
    status: "pending"

# Execution estimates:
# - Sequential time: ~1170 minutes (~19.5 hours)
# - Parallel optimized: ~650 minutes (~10.8 hours)
# - Agents engaged: 14 (all)
# - Phases: 6 (0-5)
# - Checkpoints: 3 (PRD, Architecture, Foundation)
