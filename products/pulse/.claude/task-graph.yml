# Pulse - AI-Powered Developer Intelligence Platform
# Task Graph - New Product Workflow

metadata:
  product: "pulse"
  version: "1.0.0"
  workflow_type: "new-product"
  created_at: "2026-02-07T10:00:00Z"
  updated_at: "2026-02-07T10:00:00Z"
  description: >
    Pulse - AI-Powered Developer Intelligence Platform. A real-time dashboard
    that connects to GitHub repos and gives engineering leaders visibility into
    team health, code quality trends, deployment velocity, and AI-predicted
    sprint risks.

tasks:
  # ============================================================================
  # PHASE 1: INCEPTION & PLANNING
  # ============================================================================

  - id: "PRD-01"
    name: "Create Product Requirements Document"
    description: |
      Analyze CEO brief for Pulse - AI-Powered Developer Intelligence Platform.
      Core MVP features:
        1. GitHub OAuth connect and repo ingestion
        2. Real-time commit/PR/deploy activity feed via WebSocket
        3. Team velocity dashboard (PRs merged/week, cycle time, review time)
        4. Code quality trends (test coverage over time)
        5. AI sprint risk score with explanation
        6. Mobile push notifications for anomalies
      Tech stack: Fastify + Prisma + PostgreSQL backend, Next.js 14 + React 18
      frontend with real-time charts, React Native mobile app.
      Create comprehensive PRD with personas, user stories, MVP scope, success
      metrics, site map, and product addendum.
    agent: "product-manager"
    depends_on: []
    produces:
      - name: "PRD"
        type: "document"
        path: "products/pulse/docs/PRD.md"
      - name: "Product Addendum"
        type: "document"
        path: "products/pulse/.claude/addendum.md"
    parallel_ok: false
    checkpoint: true
    priority: "critical"
    estimated_time_minutes: 120
    acceptance_criteria:
      - "PRD follows template structure"
      - "All 6 MVP features have user stories with acceptance criteria"
      - "3+ personas defined (Engineering Manager, Tech Lead, Developer)"
      - "Site map lists every page/route"
      - "Success metrics are measurable"
      - "MVP scope clearly defined vs Phase 2"
      - "Product addendum created with tech stack and conventions"
    status: "pending"

  # ============================================================================
  # PHASE 2: ARCHITECTURE
  # ============================================================================

  - id: "ARCH-01"
    name: "Design System Architecture"
    description: |
      Create system design for Pulse based on PRD:
      - API contracts (REST + WebSocket endpoints)
      - Database schema (GitHub data model, users, teams, repos, metrics)
      - Architecture decisions (ADRs) for:
        - WebSocket vs SSE for real-time
        - GitHub API polling strategy
        - AI model for sprint risk prediction
        - Chart library selection
      - Security: GitHub OAuth flow, token storage, RBAC
      - Mobile architecture: React Native + push notifications
    agent: "architect"
    depends_on: ["PRD-01"]
    consumes:
      - name: "PRD"
        required_from_task: "PRD-01"
    produces:
      - name: "Architecture Document"
        type: "document"
        path: "products/pulse/docs/architecture.md"
      - name: "API Schema"
        type: "file"
        path: "products/pulse/docs/api-schema.yml"
      - name: "Database Schema"
        type: "file"
        path: "products/pulse/docs/db-schema.sql"
      - name: "ADRs"
        type: "directory"
        path: "products/pulse/docs/ADRs/"
    parallel_ok: false
    checkpoint: true
    priority: "critical"
    estimated_time_minutes: 180
    acceptance_criteria:
      - "API contracts define all MVP endpoints (REST + WebSocket)"
      - "Database schema covers GitHub data model"
      - "ADRs for WebSocket, GitHub polling, AI model, chart library"
      - "GitHub OAuth flow documented"
      - "Mobile push notification architecture documented"
    status: "pending"

  # ============================================================================
  # PHASE 3: FOUNDATION (Parallel)
  # ============================================================================

  - id: "DEVOPS-01"
    name: "Setup CI/CD Pipeline"
    description: |
      Configure deployment infrastructure for Pulse:
      - GitHub Actions workflows (build, test, deploy)
      - Docker configuration (API + Web + Mobile build)
      - Environment setup (dev, staging, prod)
      - Database provisioning (PostgreSQL + Redis)
      - Port assignments: Frontend 3106, Backend 5003
    agent: "devops-engineer"
    depends_on: ["ARCH-01"]
    produces:
      - name: "GitHub Actions Workflow"
        type: "file"
        path: ".github/workflows/pulse-ci.yml"
      - name: "Dockerfile"
        type: "file"
        path: "products/pulse/Dockerfile"
      - name: "Docker Compose"
        type: "file"
        path: "products/pulse/docker-compose.yml"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 90
    acceptance_criteria:
      - "CI workflow runs on PR"
      - "Docker build succeeds"
      - "Environment variables documented"
      - "Port registry updated (3106, 5003)"
    status: "pending"

  - id: "BACKEND-01"
    name: "Implement Backend Foundation"
    description: |
      Setup Pulse backend API:
      - Fastify application with TypeScript
      - Prisma ORM with PostgreSQL schema (users, teams, repos, metrics)
      - GitHub OAuth plugin
      - WebSocket support (fastify-websocket)
      - Basic middleware (logging, cors, error handling)
      - Health check endpoint
      - Copy reusable plugins from Component Registry
      - Port 5003
    agent: "backend-engineer"
    depends_on: ["ARCH-01"]
    produces:
      - name: "Backend App"
        type: "directory"
        path: "products/pulse/apps/api"
      - name: "Prisma Schema"
        type: "file"
        path: "products/pulse/apps/api/prisma/schema.prisma"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 150
    acceptance_criteria:
      - "Fastify server starts on port 5003"
      - "Database connection works"
      - "Health check returns 200"
      - "GitHub OAuth flow works"
      - "WebSocket endpoint accepts connections"
      - "At least 10 unit tests passing"
      - "Test coverage > 80%"
    status: "pending"

  - id: "FRONTEND-01"
    name: "Implement Frontend Foundation"
    description: |
      Setup Pulse web dashboard:
      - Next.js 14+ with App Router
      - Tailwind CSS + shadcn/ui components
      - Dashboard layout (sidebar, header, main content)
      - Auth pages (login via GitHub OAuth)
      - Real-time chart foundation (recharts or chart.js)
      - WebSocket client connection
      - Port 3106
    agent: "frontend-engineer"
    depends_on: ["ARCH-01"]
    produces:
      - name: "Frontend App"
        type: "directory"
        path: "products/pulse/apps/web"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 120
    acceptance_criteria:
      - "Next.js dev server starts on port 3106"
      - "Dashboard layout renders"
      - "GitHub OAuth login page works"
      - "Tailwind CSS styles apply"
      - "At least 5 component tests passing"
    status: "pending"

  - id: "DATA-01"
    name: "Design Database Schema and Seed Data"
    description: |
      Create optimized Prisma schema for Pulse:
      - User, Team, Repository models
      - Commit, PullRequest, Deployment activity models
      - MetricSnapshot for time-series data
      - SprintRisk model for AI predictions
      - NotificationPreference model
      - Indexes for time-range queries
      - Seed script with realistic test data
    agent: "data-engineer"
    depends_on: ["ARCH-01"]
    produces:
      - name: "Data Model Docs"
        type: "document"
        path: "products/pulse/docs/DATA-MODEL.md"
      - name: "Seed Script"
        type: "file"
        path: "products/pulse/apps/api/prisma/seed.ts"
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 90
    acceptance_criteria:
      - "Schema follows naming conventions"
      - "All foreign keys have indexes"
      - "Time-series queries optimized with indexes"
      - "Seed script generates realistic data"
      - "Data model documentation complete"
    status: "pending"

  # ============================================================================
  # PHASE 4: CORE FEATURES (Parallel where possible)
  # ============================================================================

  - id: "BACKEND-02"
    name: "Implement GitHub Integration Service"
    description: |
      Build GitHub data ingestion:
      - GitHub OAuth callback handler
      - Repository listing and selection
      - Webhook receiver for push/PR/deploy events
      - GitHub API polling for historical data
      - Rate limit handling for GitHub API
      - Store events in database
    agent: "backend-engineer"
    depends_on: ["BACKEND-01", "DATA-01"]
    parallel_ok: true
    checkpoint: false
    priority: "critical"
    estimated_time_minutes: 180
    acceptance_criteria:
      - "OAuth flow connects GitHub account"
      - "Repos can be listed and selected"
      - "Webhooks receive and store events"
      - "Rate limiting respected"
      - "Tests cover happy and error paths"
    status: "pending"

  - id: "BACKEND-03"
    name: "Implement WebSocket Real-Time Feed"
    description: |
      Build real-time activity broadcasting:
      - WebSocket server with room-based channels (per team/repo)
      - Event publishing on new commit/PR/deploy
      - Connection management (auth, heartbeat, reconnect)
      - Backpressure handling
    agent: "backend-engineer"
    depends_on: ["BACKEND-01"]
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 120
    acceptance_criteria:
      - "WebSocket connections authenticate"
      - "Events broadcast to subscribed clients"
      - "Heartbeat keeps connections alive"
      - "Graceful reconnection on disconnect"
    status: "pending"

  - id: "BACKEND-04"
    name: "Implement Metrics Aggregation Engine"
    description: |
      Build team velocity and code quality metrics:
      - PR merge rate (per week/month)
      - Cycle time (PR open to merge)
      - Review time (PR open to first review)
      - Test coverage tracking over time
      - Aggregation jobs (hourly/daily)
      - API endpoints for dashboard data
    agent: "backend-engineer"
    depends_on: ["BACKEND-02"]
    parallel_ok: false
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 150
    acceptance_criteria:
      - "Velocity metrics calculated correctly"
      - "Aggregation runs on schedule"
      - "API returns time-series data"
      - "Performance: queries < 200ms"
    status: "pending"

  - id: "BACKEND-05"
    name: "Implement AI Sprint Risk Engine"
    description: |
      Build AI-powered sprint risk prediction:
      - Feature extraction from velocity data
      - Risk scoring algorithm (velocity trends, PR backlog, review bottlenecks)
      - Natural language explanation generation
      - Risk history tracking
      - API endpoint for risk dashboard
    agent: "backend-engineer"
    depends_on: ["BACKEND-04"]
    parallel_ok: false
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 180
    acceptance_criteria:
      - "Risk score 0-100 with explanation"
      - "Factors identified and weighted"
      - "Historical risk tracking works"
      - "API returns risk with explanation"
    status: "pending"

  - id: "FRONTEND-02"
    name: "Implement Dashboard Views"
    description: |
      Build the core dashboard pages:
      - Activity feed (real-time via WebSocket)
      - Team velocity charts (line/bar charts)
      - Code quality trends (area charts)
      - Repository overview cards
      - Date range selector
      - Responsive layout
    agent: "frontend-engineer"
    depends_on: ["FRONTEND-01", "BACKEND-03"]
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 180
    acceptance_criteria:
      - "Activity feed updates in real-time"
      - "Charts render velocity data"
      - "Date range filter works"
      - "Responsive on desktop and tablet"
      - "Loading and error states handled"
    status: "pending"

  - id: "FRONTEND-03"
    name: "Implement Sprint Risk & Settings Pages"
    description: |
      Build remaining pages:
      - Sprint risk dashboard with AI explanation
      - GitHub settings (connected repos, webhook config)
      - Team management page
      - User profile & notification preferences
    agent: "frontend-engineer"
    depends_on: ["FRONTEND-02", "BACKEND-05"]
    parallel_ok: false
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 150
    acceptance_criteria:
      - "Risk score displayed with visual indicator"
      - "AI explanation renders clearly"
      - "Settings pages functional"
      - "Team management CRUD works"
    status: "pending"

  - id: "SECURITY-01"
    name: "Security Review and Hardening"
    description: |
      Security audit of Pulse:
      - GitHub OAuth token storage review
      - WebSocket authentication audit
      - API endpoint authorization review
      - Input validation coverage
      - Rate limiting configuration
      - RBAC enforcement
    agent: "security-engineer"
    depends_on: ["BACKEND-02", "BACKEND-03"]
    parallel_ok: true
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 90
    acceptance_criteria:
      - "No hardcoded secrets"
      - "OAuth tokens stored securely"
      - "All endpoints require auth"
      - "Input validation on all routes"
      - "Rate limiting active"
    status: "pending"

  - id: "MOBILE-01"
    name: "Implement Mobile App Foundation"
    description: |
      Build React Native mobile app for Pulse:
      - Expo + React Native setup
      - Push notification registration
      - GitHub OAuth via web view
      - Activity feed screen
      - Sprint risk summary screen
      - Anomaly notification handling
    agent: "mobile-developer"
    depends_on: ["BACKEND-03", "BACKEND-05"]
    parallel_ok: true
    checkpoint: false
    priority: "normal"
    estimated_time_minutes: 180
    acceptance_criteria:
      - "App builds for iOS and Android"
      - "Push notifications register"
      - "OAuth login works"
      - "Activity feed displays"
      - "Risk score visible"
    status: "pending"

  - id: "PERF-01"
    name: "Performance Audit and Optimization"
    description: |
      Performance review of Pulse:
      - API response time benchmarks
      - WebSocket throughput testing
      - Database query optimization
      - Frontend bundle analysis
      - Lighthouse audit
    agent: "performance-engineer"
    depends_on: ["BACKEND-04", "FRONTEND-02"]
    parallel_ok: true
    checkpoint: false
    priority: "normal"
    estimated_time_minutes: 90
    acceptance_criteria:
      - "API p95 < 200ms"
      - "WebSocket handles 100+ concurrent connections"
      - "No N+1 queries"
      - "Bundle < 200KB gzipped"
      - "Lighthouse score >= 90"
    status: "pending"

  # ============================================================================
  # PHASE 5: QUALITY & DOCUMENTATION
  # ============================================================================

  - id: "QA-01"
    name: "Setup E2E Test Framework"
    description: |
      Configure Playwright E2E tests for Pulse:
      - Playwright configuration
      - Auth fixtures (GitHub OAuth mock)
      - Page Object Models for dashboard
      - Smoke tests for all pages
      - WebSocket test utilities
    agent: "qa-engineer"
    depends_on: ["FRONTEND-02"]
    parallel_ok: false
    checkpoint: false
    priority: "high"
    estimated_time_minutes: 90
    acceptance_criteria:
      - "Playwright configured"
      - "At least 5 E2E tests"
      - "Auth fixture handles OAuth"
      - "Tests run headless"
    status: "pending"

  - id: "QA-02"
    name: "Run Testing Gate - Full Product"
    description: |
      Execute complete Testing Gate:
      - All unit tests (backend + frontend + mobile)
      - All E2E tests
      - Dev server verification
      - Visual verification
      - Console error check
    agent: "qa-engineer"
    depends_on: ["FRONTEND-03", "SECURITY-01", "QA-01"]
    parallel_ok: false
    checkpoint: false
    priority: "critical"
    estimated_time_minutes: 60
    acceptance_criteria:
      - "All unit tests pass"
      - "All E2E tests pass"
      - "App loads without errors"
      - "All UI elements visible"
    status: "pending"

  - id: "UIUX-01"
    name: "UI/UX Review and Polish"
    description: |
      Design review of Pulse dashboard:
      - Accessibility audit (WCAG 2.1 AA)
      - Color contrast verification
      - Responsive breakpoint testing
      - Chart readability review
      - Dark mode verification
      - Loading state animations
    agent: "ui-ux-designer"
    depends_on: ["FRONTEND-03"]
    parallel_ok: true
    checkpoint: false
    priority: "normal"
    estimated_time_minutes: 60
    acceptance_criteria:
      - "WCAG 2.1 AA compliance"
      - "Charts readable at all sizes"
      - "Dark mode works"
      - "Consistent spacing/typography"
    status: "pending"

  - id: "DOCS-01"
    name: "Create Product Documentation"
    description: |
      Document Pulse:
      - README with setup instructions
      - API documentation
      - WebSocket protocol documentation
      - Development guide
      - Deployment guide
    agent: "technical-writer"
    depends_on: ["BACKEND-05", "FRONTEND-03"]
    parallel_ok: true
    checkpoint: false
    priority: "normal"
    estimated_time_minutes: 60
    acceptance_criteria:
      - "README has setup instructions"
      - "API endpoints documented"
      - "WebSocket protocol documented"
      - "Development guide complete"
    status: "pending"

  # ============================================================================
  # CHECKPOINT: PRODUCT COMPLETE
  # ============================================================================

  - id: "CHECKPOINT-COMPLETE"
    name: "Product Complete - CEO Review"
    description: |
      Pulse is complete and tested. Ready for CEO review:
      - All 6 MVP features implemented
      - Backend API running (port 5003)
      - Frontend dashboard running (port 3106)
      - Mobile app building
      - All tests passing
      - Security reviewed
      - Performance optimized
      - Documentation complete
    agent: "orchestrator"
    depends_on: ["QA-02", "DOCS-01", "UIUX-01", "PERF-01", "MOBILE-01"]
    parallel_ok: false
    checkpoint: true
    priority: "critical"
    estimated_time_minutes: 0
    status: "pending"
